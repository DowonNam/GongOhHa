<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title th:text="${group.name} + ' 그룹'">그룹 디테일</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.10.2/dist/full.min.css" rel="stylesheet" type="text/css"/>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
<nav th:replace="~{navbar :: navbarFragment}"></nav>

<div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold mt-10 mb-4" th:text="${group.name} + ' 그룹 상세보기'"></h1>

    <div class="mb-4">
        <a class="btn btn-primary" th:href="@{/group/edit/{id}(id=${group.id})}">그룹 편집</a>
    </div>

    <h2 class="text-2xl font-semibold mb-2">그룹 소개</h2>
    <p class="mb-4" th:text="${group.goal}">그룹 소개 내용</p>

    <h2 class="text-2xl font-semibold mb-2">그룹장</h2>
    <p class="mb-4" th:text="${group.leader.userNickname}">그룹장 이름</p>

    <h2 class="text-2xl font-semibold mb-2">멤버 구성</h2>
    <table class="table table-zebra w-full">
        <thead>
        <tr>
            <th>멤버 이름</th>
            <th>멤버 프로필</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="member : ${group.members}">
            <td th:text="${member.userNickname}"></td>
            <td>
                <a class="btn btn-info btn-xs" th:href="@{/user/detail/{id}(id=${member.id})}">Details</a>
            </td>
        </tr>
        </tbody>
    </table>

    <h2 class="text-2xl font-semibold mb-2">태그 목록</h2>
    <ul class="list-disc pl-5">
        <li th:each="groupTag : ${group.groupTagList}">
            <span class="badge badge-ghost badge-lm" th:text="${groupTag.tag.name}"></span>
            <form th:action="@{/group/{groupId}/tags/{groupTagId}/delete(groupId=${group.id}, groupTagId=${groupTag.id})}" method="post" class="inline">
                <button type="submit" class="btn btn-error btn-xs">삭제</button>
            </form>
        </li>
    </ul>

    <a href="#my_modal_8" class="btn">태그추가</a>
</div>

<!-- Put this part before </body> tag -->
<div class="modal" role="dialog" id="my_modal_8">
    <div class="modal-box">
        <h3 class="font-bold text-lg">태그 추가</h3>
        <form th:action="@{/group/{groupId}/tags/create(groupId=${group.id})}" method="post">
            <input type="text" id="tagInput" name="name" class="input input-bordered w-full mb-2" placeholder="태그 이름">
            <button type="submit" class="btn btn-primary w-full">태그 추가</button>
        </form>
        <h3 class="font-bold text-lg mt-4">태그 목록</h3>
        <ul class="list-disc pl-5 mt-10">
            <li th:each="tag : ${tags}">
                <span th:text="${tag.name}" th:attr="data-tag-name=${tag.name}"></span>
            </li>
        </ul>
        <div class="modal-action">
            <a href="#" class="btn">닫기</a>
        </div>
    </div>
</div>

<script th:inline="javascript">
    function setTagName(tagName) {
        document.getElementById('tagInput').value = tagName;
    }

    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.badge[data-tag-name]').forEach(function(element) {
            element.addEventListener('click', function() {
                setTagName(this.getAttribute('data-tag-name'));
            });
        });
    });
</script>
</body>
</html>
